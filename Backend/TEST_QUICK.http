### ================================================
### QUICK TEST - Payment System
### ================================================

@baseUrl = http://localhost:5000

### Step 1: Login (Thay username/password của bạn)
POST {{baseUrl}}/v1/Auth/Login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}

### Step 2: Add sản phẩm vào giỏ (2 sản phẩm x 1000đ = 2000đ)
POST {{baseUrl}}/v1/Cart/Add
Content-Type: application/json

{
  "productId": 1,
  "quantity": 2
}

### Step 3: Checkout Transfer
POST {{baseUrl}}/v1/Checkout/Transfer

### Step 4: Generate QR (Thay orderId từ step 3)
POST {{baseUrl}}/v1/Payment/GenerateQr
Content-Type: application/json

{
  "orderId": 1,
  "amount": 2000
}

### Step 5: Test Webhook (Thay gencode từ step 4)
POST {{baseUrl}}/v1/Payment/WebhookBalance
Content-Type: application/json

{
  "TransactionId": "TEST123456",
  "Amount": 2000,
  "Description": "Thanh toan don hang PAY_ABC123",
  "SenderAccount": "0123456789",
  "SenderName": "NGUYEN VAN A",
  "ReceiverAccount": "9876543210",
  "ReceiverName": "MODERN ISSUES",
  "BankCode": "VCB",
  "TransactionDate": "2025-11-07T14:30:00Z",
  "TransactionType": "IN"
}

### ================================================
### Verify Database
### ================================================
### Run in psql:
### SELECT * FROM orders WHERE order_id = 1;
### SELECT * FROM balance_changes ORDER BY created_at DESC LIMIT 5;
### ================================================

